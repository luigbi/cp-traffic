

<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="HelpNDoc Professional Edition 7.9.1.631">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="favicon.ico"/>

  <title>Archive</title>
  <meta name="description" content="" /> 
  <meta name="keywords" content="">



  

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Archive">
  <meta name="twitter:description" content="">

  <!-- Open Graph data -->
  <meta property="og:title" content="Archive" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="" />
  <meta property="og:site_name" content="Counterpoint Help System" /> 

  <!-- Bootstrap core CSS -->
  <link href="vendors/bootstrap-3.4.1/css/bootstrap.min.css" rel="stylesheet"/>

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="vendors/bootstrap-3.4.1/css/ie10-viewport-bug-workaround.css" rel="stylesheet"/>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="vendors/html5shiv-3.7.3/html5shiv.min.js"></script>
      <script src="vendors/respond-1.4.2/respond.min.js"></script>
    <![endif]-->

  <!-- JsTree styles -->
  <link href="vendors/jstree-3.3.10/themes/default/style.min.css" rel="stylesheet"/>

  <!-- Hnd styles -->
  <link href="css/layout.min.css" rel="stylesheet" />
  <link href="css/effects.min.css" rel="stylesheet" />
  <link href="css/theme-light-blue.min.css" rel="stylesheet" />
  <link href="css/print.min.css" rel="stylesheet" media="print" />
  <style type="text/css">nav { width: 350px} @media screen and (min-width:769px) { body.md-nav-expanded div#main { margin-left: 350px} body.md-nav-expanded header { padding-left: 364px} }</style>
  <style type="text/css">.navigation #inline-toc { width: auto !important}</style>

  <!-- Content style -->
  <link href="css/hnd.content.css" rel="stylesheet" />

  



</head>

<body class="md-nav-expanded">



  <div id="skip-link">
    <a href="#main-content" class="element-invisible">Skip to main content</a>
  </div>

  <header class="headroom">
    <button class="hnd-toggle btn btn-default">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>        
    </button>
    <h1>Counterpoint Help System</h1>
    
  </header>

  <nav id="panel-left" class="md-nav-expanded">
    <!-- Nav tabs -->
    <ul class="tab-tabs nav nav-tabs" role="tablist">
      <li id="nav-close"> 
        <button class="hnd-toggle btn btn-default">
          <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
        </button>
      </li>
      
	  
        <li role="presentation" class="tab active">
            <a href="#contents" id="tab-contents" aria-controls="contents" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-list"></i>
                Contents
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#index" id="tab-index" aria-controls="index" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-asterisk"></i>
                Index
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#search" id="tab-search" aria-controls="search" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-search"></i>
                Search
            </a>
        </li>
      
    </ul>  <!-- /Nav tabs -->

    <!-- Tab panes -->
    <div class="tab-content">
	  
      <div role="tabpanel" class="tab-pane active" id="contents">
        <div id="toc" class="tree-container unselectable"
            data-url="_toc.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /contents-->
      
      <div role="tabpanel" class="tab-pane" id="index">
        <div id="keywords" class="tree-container unselectable"
            data-url="_keywords.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /index-->
      
      <div role="tabpanel" class="tab-pane" id="search">
        <div class="search-content">
          <div class="search-input">
            <form id="search-form">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" class="form-control" id="input-search" name="input-search" placeholder="Search..." />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit">
                      <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                    </button>
                  </span>
                </div>
              </div>
            </form>
          </div>  <!-- /search-input -->
          <div class="search-result">
            <div id="search-info"></div>
            <div class="tree-container unselectable" id="search-tree"></div>
          </div>  <!-- /search-result -->
        </div>  <!-- /search-content -->
      </div>  <!-- /search-->
      
    </div>  <!-- /Tab panes -->

  </nav>

  <div id="main">

    <article>
        <div id="topic-content" class="container-fluid" 
		  data-hnd-id="Archive"
		  data-hnd-context="477"
		  data-hnd-title="Archive"
		>
            
                <div class="navigation">
                    <ol class="breadcrumb">
                        <li><a href="TrafficandAccountingSystem.html">Traffic and Accounting System</a></li><li><a href="TrafficUtilities.html">Traffic Utilities</a></li>
                    </ol>
                    <div class="nav-arrows">
                        <div class="btn-group btn-group" role="group"><a class="btn btn-default" href="TrafficUtilities.html" title="Traffic Utilities" role="button"><span class="glyphicon glyphicon-menu-up" aria-hidden="true"></span></a><a class="btn btn-default" href="TrafficUtilities.html" title="Traffic Utilities" role="button"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span></a><a class="btn btn-default" href="CFFCheck.html" title="CFF Check" role="button"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span></a></div>
                    </div>
                </div> 
            

            <a id="main-content"></a>

            <h2>Archive</h2>

            <div class="main-content">
                
<p class="rvps2"><span class="rvts6">The Counterpoint Archive program gathers data prior to a defined date, removes it from the database, and places it in an archive folder. The Archive program can be generated manually or set up to run automatically.&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">The date as of which data will be archived or purged is determined by subtracting the number of months to retain (defined in the Traffic Site Option screen) from the last standard month billed date.&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">All Traffic and Affiliate Spot information including contract information, copy rotations, and posted status is purged and archived (for records prior to the archive date). This information can be viewed on the archive files using Microsoft Excel.</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">The following records are also purged (and not archived): Affiliate Agreements, Programming, Proposals, Projections, Blackouts, Advertisers/Agencies, Rate Cards, Research, Salespeople, Vehicles, Export Journal records, and Report Queue records, using the criteria listed below:</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<ul style="text-indent: 0px; padding: 0; margin: 0 0 0 24px; list-style-position: outside; list-style-type: disc;">
 <li class="rvps4"><span class="rvts12">Advertisers: if not used by contracts, receivables, or history for two months from the current date</span></li>
 <li class="rvps4"><span class="rvts12">Agencies: if not used by contracts, receivables, or history for two months from the current date</span></li>
 <li class="rvps4"><span class="rvts12">Rate Cards: if the rate card year is older than the current year minus one year (for example, if the current year is 2018, any unused rate card older than 2017 is removed)</span></li>
 <li class="rvps4"><span class="rvts12">Research: the cutoff date for research books is determined by the Site Options setting "Retain expired contracts for X broadcast months from end of last invoicing", along with the research book date. When the archive is run, the contracts are processed before the research books are processed, and after doing that, if there's now a research book that no contract currently in the system is referencing, and that has a book date prior to the cutoff date, and that is not being used as a population source for any research book currently in the system, then the research book will be purged. On the other hand, if that research book was being used as a population source by a current research book, even if the book date (of the research book that is being used as a population source) is prior to the cutoff date, it will not be purged, since it's still being used as a population source.</span></li>
 <li class="rvps4"><span class="rvts12">Salesperson: if marked as dormant</span></li>
 <li class="rvps4"><span class="rvts12">Vehicles: if marked as dormant</span></li>
 <li class="rvps4"><span class="rvts12">Export Journal: Any records older than the cutoff date for the removal of affiliate spots</span></li>
 <li class="rvps4"><span class="rvts12">Report Queue: Any records older than one day in the past</span></li>
</ul>
<h2 class="rvps8"><span class="rvts0"><span class="rvts31">Setup</span></span></h2>
<p class="rvps2"><span class="rvts6">Create a history folder in which to store the archived data.&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">The folder can be located in:</span></p>
<ul style="text-indent: 0px; padding: 0; margin: 0 0 0 24px; list-style-position: outside; list-style-type: disc;">
 <li style="margin-left: 0px; text-indent: 0px" class="rvps25"><span class="rvts6">CSI\Prod\History or</span></li>
 <li style="margin-left: 0px; text-indent: 0px" class="rvps25"><span class="rvts6">Anywhere on the server not under CSI (verify read/write rights) or</span></li>
 <li style="margin-left: 0px; text-indent: 0px" class="rvps25"><span class="rvts6">On a different server from CSI (verify read/write rights)</span></li>
</ul>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">Due to the file sizes, the last two options are recommended.&nbsp;</span></p>
<h3 class="rvps11"><span class="rvts0"><span class="rvts34">Edit Traffic.ini</span></span></h3>
<p class="rvps2"><span class="rvts6">Add Archive = csi\prod\history (location of history folder) to the Traffic.ini.&nbsp;</span></p>
<h3 class="rvps11"><span class="rvts0"><span class="rvts34">Site Options -&gt; General Tab</span></span></h3>
<p class="rvps2"><span class="rvts6">There are six questions that allow you to control the period to archive. &nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><img width="624" height="363" alt="" style="padding : 1px;" src="lib/NewItem1466.png"></p>
<p class="rvps14"><span class="rvts6"><br/></span></p>
<ul style="text-indent: 0px; padding: 0; margin: 0 0 0 24px; list-style-position: outside; list-style-type: disc;">
 <li style="margin-left: 0px" class="rvps40"><span class="rvts12">Archiving is based on the last standard broadcast invoice date</span></li>
 <li style="margin-left: 0px" class="rvps40"><span class="rvts12">Entering a number of months of 500 or larger results in bypassing that archive</span></li>
 <li style="margin-left: 0px" class="rvps40"><span class="rvts12">The amount of months to retain each of the items can be different</span></li>
 <ul style="text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside; list-style-type: circle;">
  <li style="margin-left: 0px" class="rvps47"><span class="rvts12">If the values are different, the following rules are followed:</span></li>
  <ul style="text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside; list-style-type: square;">
   <li style="margin-left: 0px" class="rvps48"><span class="rvts12">Traffic Spots cannot be deleted if Affiliate spots exist</span></li>
   <li style="margin-left: 0px" class="rvps48"><span class="rvts12">Contracts cannot be deleted if Projections exits</span></li>
   <li style="margin-left: 0px" class="rvps48"><span class="rvts12">Expired Contracts cannot be deleted if Spots exist</span></li>
   <li style="margin-left: 0px" class="rvps48"><span class="rvts12">Retaining Dead and Expired Contracts are independent from the other questions</span></li>
  </ul>
 </ul>
</ul>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<h2 class="rvps8"><span class="rvts0"><span class="rvts31">Automatic Setup</span></span></h2>
<h3 class="rvps11"><span class="rvts0"><span class="rvts34">Edit CSI_Server.ini</span></span></h3>
<p class="rvps2"><span class="rvts6">The CSI_Server.ini file contains the settings that determine when the Archive is automatically run. &nbsp;To edit these settings, browse to the CSI\Prod\Exe folder and open the CSI_Server.ini file, and locate/create the section [Archive].&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">The Start In Folder must be referencing the location of a traffic.ini that will work on the server (i.e. map drive defined or the server drive letters defined).</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts88">[Archive]</span></p>
<p class="rvps2"><span class="rvts88">Enabled = 1&nbsp;</span></p>
<p class="rvps2"><span class="rvts88">WeekDays = 1111111</span></p>
<p class="rvps2"><span class="rvts88">Interval = 86400</span></p>
<p class="rvps2"><span class="rvts88">StartTime = 10:00PM</span></p>
<p class="rvps2"><span class="rvts88">MonthDaysToRun = 10</span></p>
<p class="rvps2"><span class="rvts88">WeekNumber = 3</span></p>
<p class="rvps2"><span class="rvts88">TimeSlot =&nbsp;</span></p>
<p class="rvps2"><span class="rvts88">Exe = x\csi\Prod\Exe\Archive.exe</span></p>
<p class="rvps2"><span class="rvts88">StartInFolder = CSI\Prod\data (database name)</span></p>
<p class="rvps2"><span class="rvts88">CommandLine = \NoDLL</span></p>
<p class="rvps2"><span class="rvts88">KeepProgramRunning = 1</span></p>
<h3 class="rvps11"><span class="rvts0"><span class="rvts215">CSI_Server.ini Section Descriptions</span></span></h3>
<p class="rvps2"><span class="rvts83">Enabled</span></p>
<p class="rvps2"><span class="rvts6">Is used to turn a task on or off. &nbsp;Value 0 = disabled, 1 = enabled. &nbsp;Set this to 1 for this feature to automatically run.</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts83">WeekDays</span></p>
<p class="rvps2"><span class="rvts6">Allows a specific week day to be selected. Week days are defined using seven 1’s and 0’s (0 = disabled, 1 = enabled). Example: WeekDays = 1111100. &nbsp;This turns Sat and Sun off.&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts83">Interval</span></p>
<p class="rvps2"><span class="rvts6">Interval defines the next time the application is to be run. For example, if the start time is set to 2pm, and the interval is set to 86400 seconds (the number of seconds in a 24 hour period), then this application will be started every day at 2pm. &nbsp;If the interval is set to 3600, the application will start at 2pm and then be started every hour after that.</span></p>
<p class="rvps2"><span class="rvts83"><br/></span></p>
<p class="rvps2"><span class="rvts83">StartTime</span></p>
<p class="rvps2"><span class="rvts6">This is the time of day to start the application. The time can be entered in several different formats (h:m:ss, H, hh:mm, etc).&nbsp;</span></p>
<p class="rvps2"><span class="rvts83"><br/></span></p>
<p class="rvps2"><span class="rvts83">MonthDaysToRun&nbsp;</span></p>
<p class="rvps2"><span class="rvts6">This can be used to specify a specific day or days on which to run the archive. Valid ranges are 1-31. Any values outside of this range will be considered as all days being specified. For instance, zero or blank turns this setting off and the task will be run on all days.&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">Example: MonthDaysToRun = 1, 15, 30</span></p>
<p class="rvps2"><span class="rvts32"><br/></span></p>
<p class="rvps2"><span class="rvts32">WeekNumber</span></p>
<p class="rvps2"><span class="rvts6">This can be used to specify the broadcast week in which to run the archive.</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">Example: WeekNumber = 52 &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps2"><span class="rvts6">&nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps2"><span class="rvts6">NOTE: &nbsp;When this setting is used, WeekDays would normally only have one day turned on. For example, if WeekNumber is set to 2, then WeekDays would be set as 0000001, which would run the task in the second broadcast week on Sunday only.</span></p>
<p class="rvps2"><span class="rvts83"><br/></span></p>
<p class="rvps2"><span class="rvts83">TimeSlot&nbsp;</span></p>
<p class="rvps2"><span class="rvts6">This is used to specify that a task is only to be run between certain hours. Leaving this setting blank = All times on.</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">Example: TimeSlot = 6am, 6pm&nbsp;</span></p>
<p class="rvps2"><span class="rvts83"><br/></span></p>
<p class="rvps2"><span class="rvts83">Exe</span></p>
<p class="rvps2"><span class="rvts6">This must be the location of the CSIArchive.EXE</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">Example: Exe = C:\CSI\Prod\Exe\CSIArchive.exe</span></p>
<p class="rvps2"><span class="rvts83"><br/></span></p>
<p class="rvps2"><span class="rvts83">StartInFolder</span></p>
<p class="rvps2"><span class="rvts6">This must be the location of the database.</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">Example: StartInFolder = x:\CSI\Prod\data</span></p>
<p class="rvps2"><span class="rvts83"><br/></span></p>
<p class="rvps2"><span class="rvts83">CommandLine</span></p>
<p class="rvps2"><span class="rvts6">This setting gets passed to the task as a command line entry.</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">Example: CommandLine = /NoDLL</span></p>
<p class="rvps2"><span class="rvts32"><br/></span></p>
<p class="rvps2"><span class="rvts32">KeepProgramRunning</span></p>
<p class="rvps2"><span class="rvts6">This setting should be set to 0.</span></p>
<h2 class="rvps8"><span class="rvts0"><span class="rvts31">Manual Setup</span></span></h2>
<p class="rvps2"><span class="rvts6">Manual mode is used when initially setting up data archive for clients who have never archived their database.&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">Create a shortcut with the Target pointing to CSI\Prod\EXE\CsiArchive.Exe, and the Start in pointing to the Traffic.ini, typically CSI\Prod\Data.&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">Add /NoDLL to the Target (see example below).</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">Adding /UserInput to the Target will allow you to see a date verification screen prior to archiving. This is recommended, especially for the first archive.&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><img width="354" height="333" alt="" style="padding : 1px;" src="lib/NewItem1465.png"></p>
<h2 class="rvps8"><span class="rvts0"><span class="rvts216">Running the Archive Utility</span></span></h2>
<p class="rvps2"><span class="rvts6">All users should be off the system during the archive process, to block users from the system during this process, see IT Utilities.&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">A backup of the database is created as part of the Archive before any file is archived. CSI_Server must be running during the Archiving process to create the backup.</span></p>
<h3 class="rvps11"><span class="rvts0"><span class="rvts34">Automatic Archive</span></span></h3>
<p class="rvps2"><span class="rvts6">The archive will automatically run based on the settings in the CSI_Server.INI. You can verify the status of the archive by looking at the csiarchive.txt, located in the CSI\Prod\Data\Messages folder. &nbsp;</span></p>
<h3 class="rvps11"><span class="rvts0"><span class="rvts34">Manual Archive</span></span></h3>
<p class="rvps2"><span class="rvts6">To run the Archive manually, double click on the CSI Archive icon. Depending upon your setup, you may see a date verification screen. When the screen first appears the dates will be blank while the system researches the proper dates to archive based on the Site Option values. Once determined, they will be displayed. Throughout the archiving process, this screen will display a progress bar.</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">If you are running a manual archive, a progress bar is shown on the archive screen.</span></p>
<h2 class="rvps8"><span class="rvts0"><span class="rvts31">File Rebuild</span></span></h2>
<p class="rvps2"><span class="rvts6">After the first archive is complete, you must perform a Pervasive File Rebuild. &nbsp;This will ensure the files will remain approximately the same size thereafter, as roughly the same number of records will be archived and added each month.</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">The Pervasive Rebuild will:</span></p>
<ol style="text-indent: 0px; padding: 0; margin: 0 0 0 24px; list-style-position: outside;">
 <li style="margin-left: 0px; text-indent: 0px" class="rvps25"><span class="rvts6">Speed up the system</span></li>
 <li style="margin-left: 0px; text-indent: 0px" class="rvps25"><span class="rvts6">Shrink the size of the database</span></li>
 <ol style="text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside;">
  <li style="margin-left: 0px; text-indent: 0px" class="rvps16"><span class="rvts6">When data is deleted in a Pervasive database, it is not removed, but hidden. &nbsp;Rebuilding the file(s) copies only the active records to a new location</span></li>
 </ol>
</ol>
<h2 class="rvps8"><span class="rvts0"><span class="rvts31">Rebuild Procedures</span></span></h2>
<ol style="text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside;">
 <li style="margin-left: 0px; text-indent: 0px" class="rvps25"><span class="rvts6">Backup of the database</span></li>
 <li style="margin-left: 0px; text-indent: 0px" class="rvps25"><span class="rvts6">Create a sub-folder of data called Rebuild (CSI\Prod\Data\Rebuild)</span></li>
 <ol style="text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside; list-style-type: lower-alpha;">
  <li style="margin-left: 0px; text-indent: 0px" class="rvps16"><span class="rvts6">If a rebuild folder is already defined, delete any contents within the folder before proceeding</span></li>
 </ol>
 <li style="margin-left: 0px; text-indent: 0px" class="rvps25"><span class="rvts6">Initiate Rebuild</span></li>
 <ol style="text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside; list-style-type: lower-alpha;">
  <li style="margin-left: 0px; text-indent: 0px" class="rvps16"><span class="rvts6">Start -&gt; All Programs -&gt; Pervasive-&gt; SQL 11 -&gt; Utilities -&gt; Rebuild</span></li>
 </ol>
 <li class="rvps4"><span class="rvts12">Once you select Rebuild, the following screen will appear, click Next.</span></li>
</ol>
<p class="rvps2"><img width="425" height="345" alt="" style="padding : 1px;" src="lib/NewItem1464.png"></p>
<p class="rvps3"><span class="rvts6"><br/></span></p>
<ol style="text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside;">
 <li value="5" style="margin-left: 0px; text-indent: 0px" class="rvps25"><span class="rvts6">Click Add.</span></li>
</ol>
<p class="rvps2"><img width="428" height="186" alt="" style="padding : 1px;" src="lib/NewItem1463.png"></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<ol style="text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside;">
 <li value="6" style="margin-left: 0px; text-indent: 0px" class="rvps25"><span class="rvts6">Browse to CSI\Prod\Data</span></li>
 <ol style="text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside; list-style-type: lower-alpha;">
  <li style="margin-left: 0px" class="rvps9"><span class="rvts12">Select all BTR and MKD (if using the Affiliate System) files and click Open.</span></li>
  <li style="margin-left: 0px; text-indent: 0px" class="rvps16"><span class="rvts6">Do this by sorting the files by type. Select the first file: &nbsp;ADF, scroll to the last file and hold the Shift Key down and select the last BTR/MKD file&nbsp;</span></li>
 </ol>
</ol>
<p class="rvps2"><img width="445" height="320" alt="" style="padding : 1px;" src="lib/NewItem1462.png"></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<ol style="text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside;">
 <li value="7" class="rvps4"><span class="rvts12">Selected all files to Rebuild and click Next.</span></li>
 <li class="rvps4"><span class="rvts12">Set the values in options</span></li>
 <ol style="text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside; list-style-type: lower-alpha;">
  <li style="margin-left: 0px; text-indent: 0px" class="rvps16"><span class="rvts6">Choose “Add/Replace System Data and Key” option.</span></li>
  <li style="margin-left: 0px; text-indent: 0px" class="rvps16"><span class="rvts6">Browse the Output Path field to point to the Rebuild folder you previously created.</span></li>
  <li style="margin-left: 0px; text-indent: 0px" class="rvps16"><span class="rvts6">Change the Log File path to go to the Rebuild folder if you want to easily view the output log.</span></li>
 </ol>
 <li class="rvps4"><span class="rvts12">Click Next to initiate the Rebuild&nbsp;</span></li>
 <li class="rvps4"><span class="rvts12">Each file will be listed as it is rebuilt</span></li>
 <li style="margin-left: 0px; text-indent: 0px" class="rvps25"><span class="rvts6">Completed Rebuild. &nbsp;Once the Rebuild is completed you should see the &nbsp;rebuild screen with the message, “The files were built successfully”</span></li>
 <li style="margin-left: 0px; text-indent: 0px" class="rvps25"><span class="rvts6"> Click Finish to exit&nbsp;</span></li>
 <li style="margin-left: 0px; text-indent: 0px" class="rvps25"><span class="rvts6">Select and copy ALL rebuilt data (BTR and MKD) files from your CSI\Prod\Rebuild folder and paste them into your CSI\Prod\Data folder&nbsp;</span></li>
</ol>
<h2 class="rvps8"><span class="rvts0"><span class="rvts52">Archive Output</span></span></h2>
<h3 class="rvps11"><span class="rvts0"><span class="rvts34">Archive Verification</span></span></h3>
<p class="rvps2"><span class="rvts6">Two log files are created and stored in the CSI\Prod\Data\Messages folder: “csiArchive” and “csiArchiveRemovalDetail”.&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">The &nbsp;csiarchive.txt will show:</span></p>
<ul style="text-indent: 0px; padding: 0; margin: 0 0 0 24px; list-style-position: outside; list-style-type: disc;">
 <li style="margin-left: 0px; text-indent: 0px" class="rvps18"><span class="rvts6">When the archive started&nbsp;</span></li>
 <li style="margin-left: 0px; text-indent: 0px" class="rvps18"><span class="rvts6">The method (manual or automatic)</span></li>
 <li style="margin-left: 0px; text-indent: 0px" class="rvps18"><span class="rvts6">The archived date range&nbsp;</span></li>
 <li style="margin-left: 0px; text-indent: 0px" class="rvps18"><span class="rvts6">The number of affiliate spots, log spots, contract spots, affiliate agreements, copy rotations, etc., archived for each month</span></li>
 <li style="margin-left: 0px; text-indent: 0px" class="rvps18"><span class="rvts6">The number of research books, vehicles, unused advertisers, etc., purged</span></li>
 <li style="margin-left: 0px; text-indent: 0px" class="rvps18"><span class="rvts6">The date and time it was completed</span></li>
</ul>
<h2 class="rvps8"><span class="rvts0"><span class="rvts31">Archive File Information</span></span></h2>
<p class="rvps2"><span class="rvts6">Each archived month is stored in its own folder, with the name Archive, year, month, and last day of broadcast month.&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">Within each month’s folder are two to three Excel files, depending on whether you use the Affiliate System: Affiliate Spots, Copy Rotations, and Traffic Spots.&nbsp;</span></p>
<h2 class="rvps8"><span class="rvts0"><span class="rvts31">Output Examples</span></span></h2>
<p class="rvps2"><span class="rvts6">The information from each system field is stored in its own Excel column, and can easily be sorted and edited. As Counterpoint develops new data fields, those fields are added to the archive utility, and placed to the right of the last current column, ensuring that the previous data fields will continue to line up with prior archived records.&nbsp;</span></p>
<h3 class="rvps11"><span class="rvts0"><span class="rvts34">Traffic Spots</span></span></h3>
<p class="rvps2"><span class="rvts6">All contract, copy, and scheduling information is included for each spot.</span></p>
<p class="rvps2"><img width="617" height="71" alt="" style="padding : 1px;" src="lib/NewItem1458.png"></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><img width="621" height="90" alt="" style="padding : 1px;" src="lib/NewItem1457.png"></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><img width="620" height="68" alt="" style="padding : 1px;" src="lib/NewItem1456.png"></p>
<h3 class="rvps11"><span class="rvts0"><span class="rvts34">Copy Rotation</span></span></h3>
<p class="rvps2"><span class="rvts6">All copy and rotation information is archived.&nbsp;</span></p>
<p class="rvps2"><img width="627" height="42" alt="" style="padding : 1px;" src="lib/NewItem1455.png"></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><img width="629" height="41" alt="" style="padding : 1px;" src="lib/NewItem1454.png"></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><img width="630" height="35" alt="" style="padding : 1px;" src="lib/NewItem1453.png"></p>
<h3 class="rvps11"><span class="rvts0"><span class="rvts34">Affiliate Spots</span></span></h3>
<p class="rvps2"><span class="rvts6">All information associated with each spot is archived, including its contract information, its copy, its fed and pledged times, and its posted information.&nbsp;</span></p>
<p class="rvps2"><img width="619" height="100" alt="" style="padding : 1px;" src="lib/NewItem1452.png"><span class="rvts6">&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><img width="618" height="94" alt="" style="padding : 1px;" src="lib/NewItem1451.png"></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><img width="618" height="106" alt="" style="padding : 1px;" src="lib/NewItem1450.png"></p>
<h2 class="rvps8"><span class="rvts0"><span class="rvts31">Retrieving Data</span></span></h2>
<p class="rvps2"><span class="rvts6">All archived data is saved as an Excel (xls) spreadsheet. To retrieve agency requested data, such as an aired affidavit for post buy analysis, open the spreadsheet and sort the data to achieve the desired information.&nbsp;</span></p>
<h3 class="rvps11"><span class="rvts0"><span class="rvts34">Affidavit Retrieval</span></span></h3>
<p class="rvps2"><span class="rvts6">For example, Geico requests an aired analysis of their campaign in November of 2011.&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<ol style="text-indent: 0px; padding: 0; margin: 0 0 0 24px; list-style-position: outside;">
 <li class="rvps4"><span class="rvts12">Locate the file &nbsp;&nbsp;</span></li>
 <li class="rvps4"><span class="rvts12">Open the AffSpots file. Some of the columns might be blank, and/or contain non-relevant information.</span></li>
 <li class="rvps4"><span class="rvts12">Highlight and delete any unwanted columns.</span></li>
 <li class="rvps4"><span class="rvts12">Once you have your desired columns, you can sort by Advertiser/Contract to locate the needed information, and delete all unneeded lines.</span></li>
 <li class="rvps4"><span class="rvts12">You can rearrange the order of the columns by clicking in the header column and cutting and pasting the information, to provide the data to your agency in their requested format.</span></li>
</ol>
<p class="rvps10"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">You can follow these steps to view any Traffic spot or copy information.&nbsp;</span></p>
<h2 class="rvps8"><span class="rvts0"><span class="rvts31">Archive Retrieval Utility&nbsp;</span></span></h2>
<p class="rvps2"><span class="rvts6">The Archive Retrieval utility extracts and places archived data for a single advertiser within a requested aired date span into a CSV file. &nbsp;</span></p>
<h3 class="rvps11"><span class="rvts0"><span class="rvts34">Setup</span></span></h3>
<h4 class="rvps15"><span class="rvts0"><span class="rvts45">Traffic INI</span></span></h4>
<p class="rvps2"><span class="rvts6">The utility looks at the Traffic INI to find the location of the archived data. Make sure that your INI contains the Archive path. Example: Archive = c:\csi\prod\archive</span></p>
<h4 class="rvps15"><span class="rvts0"><span class="rvts45">Shortcut</span></span></h4>
<p class="rvps80"><span class="rvts125">To run the utility, create a shortcut to the ArchiveSpotRetriever.EXE, located in the CSI\Prod\EXE folder.&nbsp;</span></p>
<p class="rvps80"><img alt="" style="padding : 1px;" src="lib/NewItem1442.png"></p>
<p class="rvps80"><span class="rvts214"><br/></span></p>
<p class="rvps80"><span class="rvts214"><br/></span></p>
<p class="rvps2"><span class="rvts6">Point the Target to the ArchiveSpotRetriever.EXE, and the Start In to the folder in which the Traffic/Affiliate.ini resides (typically, CSI\Prod\Data).</span></p>
<h2 class="rvps8"><span class="rvts0"><span class="rvts31">Running the Utility</span></span></h2>
<p class="rvps2"><span class="rvts6">Double click the shortcut.</span></p>
<p class="rvps2"><img width="620" height="339" alt="" style="padding : 1px;" src="lib/NewItem1441.png"></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<ol style="text-indent: 0px; padding: 0; margin: 0 0 0 24px; list-style-position: outside;">
 <li class="rvps4"><span class="rvts12">Enter the date range you wish to retrieve</span></li>
 <ol style="text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside;">
  <li style="margin-left: 0px" class="rvps9"><span class="rvts12">This is the Start Aired Date and End Aired date</span></li>
  <li style="margin-left: 0px" class="rvps9"><span class="rvts12">There is no limit to the amount of data the utility can process, however Excel has a limitation as to how many lines of data can be produced (one million rows). Therefore, if you have an advertiser with a very large number of spots (one that would generate more than one million rows), request the number of weeks in batches, rather than all at once.&nbsp;</span></li>
 </ol>
 <li class="rvps4"><span class="rvts12">Select one advertiser at a time&nbsp;</span></li>
 <li class="rvps4"><span class="rvts12">The utility will save the CSV file in the CSI\Prod\export folder, unless the Browse button is used to manually save the file to another folder</span></li>
 <li class="rvps4"><span class="rvts12">Click Start.</span></li>
</ol>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">The utility will look in each archive file that contains spots from the requested date span and pull information for that advertiser. The utilities progress and file results are displayed in the Total Records Scanned and Total Records Found fields.</span></p>
<h2 class="rvps8"><span class="rvts0"><span class="rvts31">Output</span></span></h2>
<p class="rvps80"><span class="rvts125">The utility will gather the desired data and place it in a CSV file called, Advertiser Name_Start Date_End Date.CSV. Example: &nbsp;Coca-Cola._1-5-15_1-11-15.CSV&nbsp;</span></p>
<h4 class="rvps15"><span class="rvts0"><span class="rvts45">Example File</span></span></h4>
<p class="rvps2"><img width="615" height="74" alt="" style="padding : 1px;" src="lib/NewItem1440.png"></p>
<p class="rvps2"><span class="rvts6">&nbsp;</span><img width="623" height="82" alt="" style="padding : 1px;" src="lib/NewItem1439.png"></p>
<p class="rvps2"><span class="rvts6">&nbsp;</span></p>
<p class="rvps2"><img width="623" height="76" alt="" style="padding : 1px;" src="lib/NewItem1438.png"></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6"></span><span class="rvts6"></span></p>

            </div>
            
            
        </div>  <!-- /#topic-content -->
    </article>

    <footer></footer>

  </div>  <!-- /#main -->

  <div class="mask" data-toggle="sm-nav-expanded"></div>
  
  <!-- Modal -->
  <div class="modal fade" id="hndModal" tabindex="-1" role="dialog" aria-labelledby="hndModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="hndModalLabel"></h4>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary modal-btn-close" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Splitter -->
  <div id="hnd-splitter" style="left: 350px"></div>  

  <!-- Scripts -->
  <script src="vendors/jquery-3.5.1/jquery.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/bootstrap.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/ie10-viewport-bug-workaround.js"></script>
  <script src="vendors/markjs-8.11.1/jquery.mark.min.js"></script>
  <script src="vendors/uri-1.19.2/uri.min.js"></script>
  <script src="vendors/imageMapResizer-1.0.10/imageMapResizer.min.js"></script>
  <script src="vendors/headroom-0.11.0/headroom.min.js"></script>
  <script src="vendors/jstree-3.3.10/jstree.min.js"></script>  
  <script src="vendors/interactjs-1.9.22/interact.min.js"></script>  

  <!-- HelpNDoc scripts -->
  <script src="js/polyfill.object.min.js"></script>
  <script src="_translations.js"></script>
  <script src="js/hndsd.min.js"></script>
  <script src="js/hndse.min.js"></script>
  <script src="js/app.min.js"></script>

  <!-- Init script -->
  <script>
    $(function() {
      // Create the app
      var app = new Hnd.App({
        searchEngineMinChars: 3
      });
      // Update translations
      hnd_ut(app);
	  // Instanciate imageMapResizer
	  imageMapResize();
	  // Custom JS
	  
      // Boot the app
      app.Boot();
    });
  </script>



</body>

</html>

